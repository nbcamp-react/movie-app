<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style/reset.css" />
    <link rel="stylesheet" href="./style/style-detail.css" />
    <title>상세페이지</title>
  </head>
  <body>
    <div class="nav"><h1>Movie Collection</h1></div>
    <div class="Movie-info-box"></div>
    <div class="cmtbox"></div>
    <div class="form-commentInfo">
      <div class="comment-count">
        <h4>댓글 쓰기 <span>0</span></h4>
        <div class="ps_box">
          <form id="commentFrm">
            <input
              type="text"
              placeholder="댓글 내용을 입력해주세요."
              class="int"
              name="content"
              id="content"
            />
            <input type="submit" class="btn" value="등록" />
          </form>
        </div>
      </div>
    </div>
    <div class="comments" id="comment-list">
      <!-- 댓글 목록이 여기에 표시됩니다. -->
    </div>
    <script src="comment_login.js"></script>
    <script>
      const commentBtn = document.querySelector('#commentFrm');
      const commentList = document.querySelector('#comment-list');
      const total = document.querySelector('h4 > span');
      const list = [];

      function Comment(content) {
        this.userid = '방문자';
        this.content = content;
        this.date = new Date();
      }

      function createRow(userid, content, date) {
        const ul = document.createElement('ul');
        const li1 = document.createElement('li');
        const li2 = document.createElement('li');
        const li3 = document.createElement('li');

        ul.append(li1);
        ul.append(li2);
        ul.append(li3);

        ul.setAttribute('class', 'comment-row');
        li1.setAttribute('class', 'comment-id');
        li2.setAttribute('class', 'comment-content');
        li3.setAttribute('class', 'comment-date');

        li1.innerHTML = userid;
        li2.innerHTML = content;
        li3.innerHTML = date;

        return ul;
      }

      function drawing() {
        commentList.innerHTML = '';
        for (let i = list.length - 1; i >= 0; i--) {
          const row = createRow(list[i].userid, list[i].content, list[i].date);
          commentList.append(row);
        }
      }

      function totalRecord() {
        total.innerHTML = `(${list.length})`;
      }

      function commentBtnHandler(e) {
        e.preventDefault();
        const input = e.target.content;
        if (input.value === '') {
          alert('내용을 넣고 등록 버튼을 눌러주세요.');
          return;
        }
        const commentObj = new Comment(input.value);
        list.push(commentObj);
        totalRecord();

        drawing();
        e.target.reset();
      }

      totalRecord();
      commentBtn.addEventListener('submit', commentBtnHandler);
    </script>
  </body>
</html>
